{"version":3,"sources":["../src/cloudpoodll.js"],"names":["root","factory","define","amd","CloudPoodll","version","baseURL","params","fetchContainers","classname","divs","document","getElementsByClassName","autoCreateRecorders","containers","ctr","length","insertRecorder","createRecorder","elementid","theelement","getElementById","container","attributes","parseAttributes","iframe","createIframe","appendChild","setAttribute","i","attr","getAttribute","hasOwnProperty","window","location","protocol","hostname","guess_mimetype","createElement","localloading","iframeurl","isIOS_safari","is_ios","is_safari","property","iframeclass","width","height","theCallback","data","type","inputControl","updatecontrol","pokeInput","theurl","mediaurl","value","alert","message","initEvents","that","addEventListener","e","sendMessage","containerid","messageObject","theiframe","getElementsByTagName","contentWindow","postMessage","fetchroot","test","navigator","userAgent","MSStream","mediatype","transcribe","hints","includes","nVer","appVersion","nAgt","browserName","appName","fullVersion","parseFloat","nameOffset","verOffset","match","indexOf","lastIndexOf","substring","toLowerCase","toUpperCase","OS","browser","name","mimetype"],"mappings":"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","sourcesContent":["\n/**\n * root is our root object context, ie. window if we are in a browser\n * factory is a method that builds and returns our module\n */\n(function(root, factory) {\n    // If AMD is available, use the define() method to load our dependencies\n    //and declare our module\n    if (typeof define === 'function' && define.amd) {\n        define([], function() {\n            return factory(root);\n        });\n    }\n    // Otherwise we will attach our module to root, and pass references to our\n    // dependencies into the factory. We're assuming that our dependencies are\n    // also attached to root here, but they could come from anywhere\n    else\n    {\n        root.CloudPoodll = factory(root);\n    }\n})(this, function(root) {\n    // This is our factory method. Return our module object here...\n    return {\n        version: '1.2.8',\n        baseURL: 'https://cloud.poodll.com/local/cpapi/fastpoodllloader.php',\n        //baseURL: 'http://localhost/moodle/local/cpapi/fastpoodllloader.php',\n        params: ['parent','appid','timelimit','type','media','updatecontrol','width','height','id',\n            'iframeclass','transcode','transcoder','transcribe','subtitle','language','transcribevocab',\n            'expiredays','owner','region','token','localloader','localloading','notificationurl',\n            'sourcemimetype','speechevents','hints','alreadyparsed','fallback'],\n\n        fetchContainers: function(classname){\n            var divs = document.getElementsByClassName(classname);\n            return divs;\n        },\n        autoCreateRecorders: function(classname){\n            if(!classname){classname='cloudpoodll';}\n            var containers = this.fetchContainers(classname);\n            for(var ctr=0;ctr<containers.length;ctr++){\n                this.insertRecorder(containers[ctr]);\n            }\n        },\n        createRecorder: function(elementid){\n            var theelement=document.getElementById(elementid);\n            this.insertRecorder(theelement);\n        },\n\n        insertRecorder: function(container, attributes){\n            if(attributes == undefined) {\n                attributes = this.parseAttributes(container);\n            }\n            var iframe = this.createIframe(attributes);\n            if(iframe) {\n                container.appendChild(iframe);\n                container.setAttribute('data-alreadyparsed','true');\n            }\n        },\n        parseAttributes: function(container){\n            var attributes = {};\n            for(var i=0;i<this.params.length;i++){\n                var attr = container.getAttribute('data-' + this.params[i]);\n                if(attr!==null){\n                    attributes[this.params[i]]=attr;\n                }\n            }\n            return attributes;\n        },\n        createIframe: function(attributes){\n\n            //cancel out if this div was already processed\n            if(attributes.hasOwnProperty('alreadyparsed') ){\n                if(attributes['alreadyparsed']=='true'){\n                   // console.log(\"Can only parse a cloudpoodll element once. Cancelling.\");\n                    return false;\n                }\n            }\n\n            //fix up default attributes if the user did not set them\n            //parent\n            if(!attributes.hasOwnProperty('parent') ){\n                attributes['parent']=window.location.protocol + '//' + window.location.hostname;\n            }\n            //media\n            if(!attributes.hasOwnProperty('media') ){\n                attributes['media']='audio';\n            }\n            //also store predicted mimetype\n            attributes['sourcemimetype'] = this.guess_mimetype(attributes['media'],attributes['transcribe'],attributes['hints']);\n\n            //build and set the iframe src url\n            var iframe = document.createElement('iframe');\n\n            //set up the base URL for the iframe\n            //if we need and can load locally from html we do that\n            if(!attributes.hasOwnProperty('localloader')){\n                var localloading = 'never';\n            }else {\n                var localloading = attributes.hasOwnProperty('localloading') ? attributes['localloading'] : 'auto';\n            }\n\n            switch(localloading){\n\n                case 'always':\n                    var iframeurl = attributes['parent'] + attributes['localloader'] + '?';\n                    break;\n\n                case 'never':\n                    var iframeurl = this.baseURL + '?';\n                    break;\n\n                case 'auto':\n                default:\n                    var isIOS_safari = this.is_ios() || this.is_safari();\n                    if(isIOS_safari) {\n                        var iframeurl = attributes['parent'] + attributes['localloader'] + '?';\n                    }else {\n                        var iframeurl = this.baseURL + '?';\n                    }\n                    break;\n            }\n\n            //build iframeurl based on baseurl and attributes\n            for (var property in attributes) {\n                iframeurl = iframeurl + property + '=' + attributes[property] + '&';\n            }\n            iframe.setAttribute('src', iframeurl);\n\n            //do any iframe attributes that we need to\n            //width and height (only if no iframe class specified)\n            //see here for responsive iframe ..https://blog.theodo.fr/2018/01/responsive-iframes-css-trick/\n            if(attributes.hasOwnProperty('iframeclass')) {\n                iframe.setAttribute('class', attributes.iframeclass);\n            }else{\n                if(!attributes.hasOwnProperty('width') ){\n                    attributes['width']=350;\n                }\n                iframe.setAttribute('width', attributes.width);\n                if(!attributes.hasOwnProperty('height') ){\n                    if(attributes['media']=='audio') {\n                        attributes['height'] = 250;\n                    }else{\n                        attributes['height'] = 550;\n                    }\n                }\n                iframe.setAttribute('height', attributes.height);\n            }\n            iframe.setAttribute('frameBorder', 0);\n            iframe.setAttribute('allow', 'camera,microphone');\n            return iframe;\n        },\n        theCallback: function(data) {\n            switch(data.type){\n                case 'filesubmitted':\n                    var inputControl = data.updatecontrol;\n                    var pokeInput = document.getElementById(inputControl);\n                    var theurl = data.mediaurl;\n                    if (pokeInput) {\n                        pokeInput.value = theurl;\n                    }\n                    break;\n                case 'error':\n                    alert('ERROR:' . data.message);\n            }\n        },\n        initEvents: function(){\n            var that = this;\n            window.addEventListener('message', function(e) {\n                var data = e.data;\n                if (data && data.hasOwnProperty('id') && data.hasOwnProperty('type')){\n                    that.theCallback(data);\n                }\n            });\n        },\n        sendMessage: function(containerid,messageObject){\n\n            if(!messageObject.hasOwnProperty('type')){\n                //'All message objects must have at least the \"type\" property'\n                return;\n            }\n\n            var theiframe = document.getElementById(containerid).getElementsByTagName('iframe')[0];\n\n            //messageObject.id = this.id;\n            theiframe.contentWindow.postMessage(messageObject);\n\n        },\n        fetchroot: function(){\n            return root;\n        },\n\n        is_safari: function(){\n            return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n        },\n\n        is_ios: function(){\n            return  /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n        },\n\n        guess_mimetype: function(mediatype, transcribe, hints){\n\n            //if we are using Google Cloud Speech Transcribe then we only support audio/wav\n            if(transcribe==2){\n                return \"audio/wav\";\n            }\n            //this is a bit hacky, we should base64decode hints and look for the value of hints.encoder\n            if(hints && hints.includes('stereoaudio')){\n                return \"audio/wav\";\n            }\n\n            var nVer = navigator.appVersion;\n            var nAgt = navigator.userAgent;\n            var browserName  = navigator.appName;\n            //decided no real benefit and some danger in detecting version, so commented it mostly\n            var fullVersion  = ''+parseFloat(navigator.appVersion);\n            var nameOffset,verOffset,ix;\n\n            if(nAgt.match('(?:Edge|EdgA|EdgiOS)')!==null) {\n                browserName=\"Edge\";\n                //dont know how to get this and its probably not important yet\n                //fullVersion = '1.0';\n\n            // In Opera, the true version is after \"Opera\" or after \"Version\"\n            }else if ((verOffset=nAgt.indexOf(\"Opera\"))!=-1) {\n                browserName = \"Opera\";\n                //fullVersion = nAgt.substring(verOffset+6);\n                //if ((verOffset=nAgt.indexOf(\"Version\"))!=-1) fullVersion = nAgt.substring(verOffset+8);\n            }\n            // In MSIE, the true version is after \"MSIE\" in userAgent\n            else if ((verOffset=nAgt.indexOf(\"MSIE\"))!=-1) {\n                browserName = \"IE\";\n                //fullVersion = nAgt.substring(verOffset+5);\n            }\n            // In Chrome, the true version is after \"Chrome\"\n            else if ((verOffset=nAgt.indexOf(\"Chrome\"))!=-1) {\n                browserName = \"Chrome\";\n                //fullVersion = nAgt.substring(verOffset+7);\n            }\n            // In Safari, the true version is after \"Safari\" or after \"Version\"\n            else if ((verOffset=nAgt.indexOf(\"Safari\"))!=-1) {\n                browserName = \"Safari\";\n                //fullVersion = nAgt.substring(verOffset+7);\n                //if ((verOffset=nAgt.indexOf(\"Version\"))!=-1)fullVersion = nAgt.substring(verOffset+8);\n            }\n            // In Firefox, the true version is after \"Firefox\"\n            else if ((verOffset=nAgt.indexOf(\"Firefox\"))!=-1) {\n                browserName = \"Firefox\";\n                //fullVersion = nAgt.substring(verOffset + 8);\n                // In most other browsers, \"name/version\" is at the end of userAgent\n            }else if ( (nameOffset=nAgt.lastIndexOf(' ')+1) <\n                (verOffset=nAgt.lastIndexOf('/')) )\n            {\n                browserName = nAgt.substring(nameOffset,verOffset);\n                //fullVersion = nAgt.substring(verOffset+1);\n                if (browserName.toLowerCase()==browserName.toUpperCase()) {\n                    browserName = navigator.appName;\n                }\n            }\n\n\n            //OS detection\n            var OS = \"Unknown OS\";\n            if (navigator.userAgent.indexOf(\"Win\") != -1){OS = \"Windows\";}\n            if (navigator.userAgent.indexOf(\"Mac\") != -1) {OS = \"Macintosh\";}\n            if (navigator.userAgent.indexOf(\"Linux\") != -1){OS = \"Linux\";}\n            if (navigator.userAgent.indexOf(\"Android\") != -1){OS = \"Android\";}\n            if (navigator.userAgent.indexOf(\"like Mac\") != -1) {OS = \"iOS\";}\n\n\n            var browser={};\n            browser.name=browserName;\n            browser.version=fullVersion;\n            browser.OS=OS;\n\n            //predicted mimetype\n            var mimetype=\"unsupported/unsupported\";\n            if(mediatype=='video'){\n                switch(browser.name){\n                    case 'Edge':\n                    case 'MSIE':\n                        mimetype=\"video/webm\";\n                        break;\n                    case 'Safari':\n                        mimetype=\"video/quicktime\";\n                        break;\n                    case 'Firefox':\n                    case 'Chrome':\n                    case 'Opera':\n                    default:\n                        mimetype=\"video/webm\";\n                }\n            }else{\n                switch(browser.name){\n                    case 'MSIE':\n                        mimetype=\"audio/wav\";\n                        break;\n                    case 'Edge':\n                    case 'Safari':\n                        mimetype=\"audio/wav\";\n                        break;\n                    case 'Firefox':\n                        mimetype=\"audio/ogg\";\n                        break;\n                    case 'Chrome':\n                    case 'Opera':\n                    default:\n                        mimetype=\"audio/webm\";\n                }\n            }\n            /*\n            document.write(''\n                +'Browser name  = '+browser.name+'<br>'\n                +'Full version  = '+browser.version+'<br>'\n                +'OS  = '+browser.OS+'<br>'\n                +'mimetype  = '+mimetype+'<br>'\n            )\n            */\n            return mimetype;\n        }//end of guess mimetype\n    };//end of returned object (poodllcloud)\n});//end of factory method container"],"file":"cloudpoodll.min.js"}