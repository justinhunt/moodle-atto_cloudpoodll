YUI.add("moodle-atto_cloudpoodll-button",function(e,t){var n="atto_cloudpoodll",r={VIDEO:"video",AUDIO:"audio"},i={},s={VIDEO:"atto_cloudpoodll_video",AUDIO:"atto_cloudpoodll_audio",UPLOAD:"atto_cloudpoodll_upload",CP_VIDEO:"atto_cloudpoodll_video_cont",CP_AUDIO:"atto_cloudpoodll_audio_cont",CP_UPLOAD:"atto_cloudpoodll_upload_cont",CP_SWAP:"atto_cloudpoodll_swapmeout"},o={ROOT:'<form class="mform atto_form atto_media" id="{{elementid}}_atto_media_form"><ul class="root nav nav-tabs" role="tablist">{{#if isvideo}}<li data-medium-type="{{CSS.VIDEO}}" class="nav-item"><a class="nav-link" href="#{{elementid}}_{{CSS.VIDEO}}" role="tab" data-toggle="tab">{{get_string "video" component}}</a></li>{{else}}<li data-medium-type="{{CSS.AUDIO}}" class="nav-item"><a class="nav-link" href="#{{elementid}}_{{CSS.AUDIO}}" role="tab" data-toggle="tab">{{get_string "audio" component}}</a></li>{{/if}}<li data-medium-type="{{CSS.UPLOAD}}" class="nav-item"><a class="nav-link active" href="#{{elementid}}_{{CSS.UPLOAD}}" role="tab" data-toggle="tab">{{get_string "upload" component}}</a></li></ul><div class="root tab-content">{{#if isvideo}}<div data-medium-type="{{CSS.VIDEO}}" class="tab-pane" id="{{elementid}}_{{CSS.VIDEO}}">some video content<div id="{{elementid}}_{{CSS.CP_VIDEO}}" class="{{CSS.CP_SWAP}}" data-id="{{elementid}}_{{CSS.CP_VIDEO}}" data-parent="{{CP.parent}}"data-media="video" data-type="{{CP.videoskin}}" data-width="450" data-height="350"data-transcode="{{CP.transcode}}" data-transcribe="0" data-transcribelanguage="{{CP.language}}"data-expiredays="{{CP.expiredays}}" data-region="{{CP.region}}" data-token="{{CP.token}}" data-fallback="{{CP.fallback}}"></div></div>{{else}}<div data-medium-type="{{CSS.AUDIO}}" class="tab-pane" id="{{elementid}}_{{CSS.AUDIO}}">some audio content</div>{{/if}}<div data-medium-type="{{CSS.UPLOAD}}" class="tab-pane active" id="{{elementid}}_{{CSS.UPLOAD}}">some upload content<div id="{{elementid}}_{{CSS.CP_VIDEO}}" class="{{CSS.CP_SWAP}}" data-id="{{elementid}}_{{CSS.CP_UPLOAD}}" data-parent="{{CP.parent}}"data-media="video" data-type="upload" data-width="450" data-height="350"data-transcode="{{CP.transcode}}" data-transcribe="0" data-transcribelanguage="{{CP.language}}"data-expiredays="{{CP.expiredays}}" data-region="{{CP.region}}" data-token="{{CP.token}}"></div></div></div></form>',TAB_PANES:{UPLOAD:'<label>Enter name<input class="fullwidth {{CSS.NAME_INPUT}}" type="text" id="{{elementid}}_link_nameentry"size="32" required="true"/></label>',VIDEO:'<fieldset class="collapsible collapsed" id="{{elementid}}_video-display-options"><input name="mform_isexpanded_{{elementid}}_video-display-options" type="hidden"><legend class="ftoggler">{{get_string "displayoptions" component}}</legend><div class="fcontainer">{{> form_components.display_options}}</div></fieldset>',AUDIO:'<fieldset class="collapsible collapsed" id="{{elementid}}_audio-advanced-settings"><input name="mform_isexpanded_{{elementid}}_audio-advanced-settings" type="hidden"><legend class="ftoggler">{{get_string "advancedsettings" component}}</legend><div class="fcontainer">{{> form_components.advanced_settings}}</div></fieldset><fieldset class="collapsible collapsed" id="{{elementid}}_audio-tracks"><input name="mform_isexpanded_{{elementid}}_audio-tracks" type="hidden"><legend class="ftoggler">{{get_string "tracks" component}} {{{helpStrings.tracks}}}</legend><div class="fcontainer">{{renderPartial "form_components.track_tabs" context=this id=CSS.AUDIO}}</div></fieldset>'},HTML_MEDIA:{VIDEO:'&nbsp;<video {{#width}}width="{{../width}}" {{/width}}{{#height}}height="{{../height}}" {{/height}}{{#poster}}poster="{{../poster}}" {{/poster}}{{#showControls}}controls="true" {{/showControls}}{{#loop}}loop="true" {{/loop}}{{#muted}}muted="true" {{/muted}}{{#autoplay}}autoplay="true" {{/autoplay}}>{{#sources}}<source src="{{source}}">{{/sources}}{{#tracks}}<track src="{{track}}" kind="{{kind}}" srclang="{{srclang}}" label="{{label}}" {{#defaultTrack}}default="true"{{/defaultTrack}}>{{/tracks}}{{#description}}{{../description}}{{/description}}</video>&nbsp',AUDIO:'&nbsp;<audio {{#showControls}}controls="true" {{/showControls}}{{#loop}}loop="true" {{/loop}}{{#muted}}muted="true" {{/muted}}{{#autoplay}}autoplay="true" {{/autoplay}}>{{#sources}}<source src="{{source}}">{{/sources}}{{#tracks}}<track src="{{track}}" kind="{{kind}}" srclang="{{srclang}}" label="{{label}}" {{#defaultTrack}}default="true"{{/defaultTrack}}>{{/tracks}}{{#description}}{{../description}}{{/description}}</audio>&nbsp',LINK:'<a href="{{url}}" {{#width}}data-width="{{../width}}" {{/width}}{{#height}}data-height="{{../height}}"{{/height}}>{{#name}}{{../name}}{{/name}}{{^name}}{{../url}}{{/name}}</a>'}};e.namespace("M.atto_cloudpoodll").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(e){var t=new Array("audio","video");for(var n=0;n<t.length;n++)e.hasOwnProperty(t[n])&&this.addButton({icon:t[n],iconComponent:"atto_cloudpoodll",title:t[n]+"_desc",buttonName:t[n],callback:this._displayDialogue,callbackArgs:t[n]});i.parent=M.cfg.wwwroot,i.token=e.cp_token,i.region=e.cp_region,i.expiredays=e.cp_expiredays,i.cansubtitle=e.cp_cansubtitle,i.language=e.cp_language,i.transcode=e.cp_transcode,i.audioskin=e.cp_audioskin,i.videoskin=e.cp_videoskin,i.fallback=e.fallback},_getContext:function(t){return e.merge({elementid:this.get("host").get("elementid"),component:n,helpStrings:this.get("help"),isvideo:this._currentrecorder==r.VIDEO,CSS:s,CP:i},t)},_displayDialogue:function(e,t){if(this.get("host").getSelection()===!1)return;this._currentrecorder=t;switch(t){case"video":var r=M.util.get_string("createvideo",n);break;case"audio":default:var r=M.util.get_string("createaudio",n)}var i=this.getDialogue({headerContent:r,focusAfterHide:t,width:660});i.set("bodyContent",this._getDialogueContent()).show();var o=this;require(["atto_cloudpoodll/cloudpoodllloader"],function(e){var t=function(e){switch(e.type){case"recording":e.action==="started";break;
case"awaitingprocessing":o.uploadstate!="posted"&&(o._doInsert(e.mediaurl,e.mediafilename),o.uploadstate="posted")}};e.init(s.CP_SWAP,t)})},_getDialogueContent:function(t){var n=e.Node.create(e.Handlebars.compile(o.ROOT)(this._getContext()));return n},_doInsert:function(e,t){this.getDialogue({focusAfterHide:null}).hide(),mediahtml='<a href="'+e+'">'+t+"</a>",this.editor.focus(),this.get("host").insertContentAtFocusPoint(mediahtml),this.markUpdated()}},{ATTRS:{disabled:{value:!1},keys:{value:null},names:{value:null},variables:{value:null},defaults:{value:null},instructions:{value:null},customicon:{value:null},ends:{value:null}}})},"@VERSION@");
